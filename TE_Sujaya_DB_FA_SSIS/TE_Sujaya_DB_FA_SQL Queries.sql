-----------CREATE TABLE----------
---AS PER NORMALIZATION---

-----CREATE TABLE DFA_HEALTHCARE_HOSPITAL-----
CREATE TABLE DFA_HEALTHCARE_HOSPITAL
(
HOSP_ID INT PRIMARY KEY,
HOSP_TYPE VARCHAR(30),
HOSP_LOC VARCHAR(30)
);

-----CREATE TABLE DFA_HEALTHCARE_DOCTOR-----
CREATE TABLE DFA_HEALTHCARE_DOCTOR 
(
 DOC_ID INT PRIMARY KEY,
 DOC_NAME VARCHAR(30),
 HOSP_ID INT,
 DOC_SPECIALIZATION VARCHAR(30)
);

-----CREATE TABLE DFA_HEALTHCARE_PATIENT-----
CREATE TABLE DFA_HEALTHCARE_PATIENT 
(
 PATIENT_ID INT PRIMARY KEY,
 PATIENT_NAME VARCHAR(30),
 PATIENT_DISEASE VARCHAR(30),
 DOC_ID INT,
 PATIENT_TREATMENT_TYPE VARCHAR(30),
 );

-----CREATE TABLE DFA_HEALTHCARE_PATIENT-----
CREATE TABLE DFA_HEALTH_CARE_TREATMENT_INFO
(
 TREATMENT_ID INT PRIMARY KEY,
 TREATMENT_DESC VARCHAR(30),
 TREATMENT_DATE DATE,
 TREATMENT_COST VARCHAR(30),
 PATIENT_ID INT FOREIGN KEY REFERENCES DFA_HEALTHCARE_PATIENT (PATIENT_ID)
);

-----CREATE TABLE DFA_HEALTHCARE_PATIENT-----
CREATE TABLE DFA_HEALTHCARE_DISHARGE_INFO
(
 DISHCHARGE_STATUS VARCHAR(30),
 DISHCHARGE_DATE DATE,
 PATIENT_ID INT FOREIGN KEY REFERENCES DFA_HEALTHCARE_PATIENT (PATIENT_ID)
);


-----ADDING FOREIGN KEY CONSRAINTS TO DFA_HEALTHCARE_DOCTOR-----
ALTER TABLE DFA_HEALTHCARE_DOCTOR 
ADD CONSTRAINT FK_HOSP_ID 
FOREIGN KEY(HOSP_ID) REFERENCES DFA_HEALTHCARE_HOSPITAL;


-----ADDING FOREIGN KEY CONSRAINTS TO DFA_HEALTHCARE_PATIENT-----
ALTER TABLE DFA_HEALTHCARE_PATIENT 
ADD CONSTRAINT FK_DOC_ID 
FOREIGN KEY(DOC_ID) REFERENCES DFA_HEALTHCARE_DOCTOR;



-----INSERT VALUES TO TABLE DFA_HEALTHCARE_HOSPITAL-----
INSERT INTO DFA_HEALTHCARE_HOSPITAL VALUES(1,'COMMUNITY','UDUPI');
INSERT INTO DFA_HEALTHCARE_HOSPITAL VALUES(2,'COMMUNITY','KOTA');
INSERT INTO DFA_HEALTHCARE_HOSPITAL VALUES(3,'CHILDRENS','MANGALORE');
INSERT INTO DFA_HEALTHCARE_HOSPITAL VALUES(4,'CHILDRENS','UDUPI');
INSERT INTO DFA_HEALTHCARE_HOSPITAL VALUES(5,'CANCER','MANIPAL');
INSERT INTO DFA_HEALTHCARE_HOSPITAL VALUES(6,'AYURVEDA','KUNDAPURA');
INSERT INTO DFA_HEALTHCARE_HOSPITAL VALUES(7,'HOMEOPATHY','NEELAVARA');
INSERT INTO DFA_HEALTHCARE_HOSPITAL VALUES(8,'ORTHO','SURATHKAL');
INSERT INTO DFA_HEALTHCARE_HOSPITAL VALUES(9,'NATUROPATHY','BRAHMAVARA');
INSERT INTO DFA_HEALTHCARE_HOSPITAL VALUES(10,'SURGICAL','KARKALA');

SELECT * FROM DFA_HEALTHCARE_HOSPITAL;

-----INSERT VALUES TO TABLE DFA_HEALTHCARE_DOCTOR-----
INSERT INTO DFA_HEALTHCARE_DOCTOR VALUES(101,'RAMARAO',1,'GENERIC');
INSERT INTO DFA_HEALTHCARE_DOCTOR VALUES(102,'SUSHMA',2,'GENERIC');
INSERT INTO DFA_HEALTHCARE_DOCTOR VALUES(103,'CHAYA',3,'PEDIATRICIAN');
INSERT INTO DFA_HEALTHCARE_DOCTOR VALUES(104,'KASTURI',10,'SURGEON');
INSERT INTO DFA_HEALTHCARE_DOCTOR VALUES(105,'KRISHNAPPA',10,'CARDIOLOGIST');
INSERT INTO DFA_HEALTHCARE_DOCTOR VALUES(106,'CHANDRASHEKAR',5,'RADIOLOGIST');
INSERT INTO DFA_HEALTHCARE_DOCTOR VALUES(107,'MEENAKSHI',5,'ONCOLOGIST');
INSERT INTO DFA_HEALTHCARE_DOCTOR VALUES(108,'SIRAJ',5,'NEUROLOGIST');
INSERT INTO DFA_HEALTHCARE_DOCTOR VALUES(109,'JAGADISH',9,'PHYSIOTHERAPY');
INSERT INTO DFA_HEALTHCARE_DOCTOR VALUES(110,'CHAITHANYA',10,'ANESTHESIA');

SELECT * FROM DFA_HEALTHCARE_DOCTOR;


-----INSERT VALUES TO TABLE DFA_HEALTHCARE_PATIENT-----
INSERT INTO DFA_HEALTHCARE_PATIENT VALUES(10,'SINA','FEVER',101,'MEDICINE');
INSERT INTO DFA_HEALTHCARE_PATIENT VALUES(20,'RAGA','FEVER',101,'MEDICINE');
INSERT INTO DFA_HEALTHCARE_PATIENT VALUES(30,'ARVAN','HEADACHE',102,'MEDICINE');
INSERT INTO DFA_HEALTHCARE_PATIENT VALUES(40,'NIRMA','STOMACHPAIN',102,'MEDICINE');
INSERT INTO DFA_HEALTHCARE_PATIENT VALUES(50,'LISA','LEG_FRACTURE',109,'BANDAGE');
INSERT INTO DFA_HEALTHCARE_PATIENT VALUES(60,'MEENA','DIPRESSION',109,'YOGA');
INSERT INTO DFA_HEALTHCARE_PATIENT VALUES(70,'MOOSHIK','LUNG_CANCER',107,'SURGERY');
INSERT INTO DFA_HEALTHCARE_PATIENT VALUES(80,'AKASH','DENGUE',102,'MEDICINE');
INSERT INTO DFA_HEALTHCARE_PATIENT VALUES(90,'SICHA','CARDIOVASCULAR',110,'SURGERY');
INSERT INTO DFA_HEALTHCARE_PATIENT VALUES(100,'NISHA','CANCER',105,'SURGERY');
DELETE FROM DFA_HEALTHCARE_PATIENT WHERE PATIENT_ID=50;

SELECT * FROM DFA_HEALTHCARE_PATIENT;

-----INSERT VALUES TO TABLE DFA_HEALTH_CARE_TREATMENT_INFO-----
INSERT INTO DFA_HEALTH_CARE_TREATMENT_INFO VALUES(201,'SURGERY','2022-10-01',100000,10);
INSERT INTO DFA_HEALTH_CARE_TREATMENT_INFO VALUES(202,'SURGERY','2022-10-05',250000,90);
INSERT INTO DFA_HEALTH_CARE_TREATMENT_INFO VALUES(203,'MRI','2022-10-07',25000,70);

SELECT * FROM DFA_HEALTH_CARE_TREATMENT_INFO;

-----INSERT VALUES TO TABLE DFA_HEALTHCARE_DISHARGE_INFO-----
INSERT INTO DFA_HEALTHCARE_DISHARGE_INFO VALUES('YES','2022-10-03',10);
INSERT INTO DFA_HEALTHCARE_DISHARGE_INFO VALUES('YES','2022-10-07',90);
INSERT INTO DFA_HEALTHCARE_DISHARGE_INFO VALUES('YES','2022-10-07',70);

SELECT * FROM DFA_HEALTHCARE_DISHARGE_INFO;

-----JOINS-----
-----INNER JOIN-----
SELECT D.DOC_NAME,D.DOC_SPECIALIZATION,P.PATIENT_ID,P.PATIENT_NAME,P.PATIENT_DISEASE,P.PATIENT_TREATMENT_TYPE
FROM DFA_HEALTHCARE_DOCTOR AS D
INNER JOIN DFA_HEALTHCARE_PATIENT AS P 
ON D.DOC_ID=P.DOC_ID;

-----LEFT JOIN-----
SELECT D.DOC_NAME,D.DOC_SPECIALIZATION,P.PATIENT_ID,P.PATIENT_NAME,P.PATIENT_DISEASE,P.PATIENT_TREATMENT_TYPE
FROM DFA_HEALTHCARE_DOCTOR AS D
LEFT JOIN DFA_HEALTHCARE_PATIENT AS P 
ON D.DOC_ID=P.DOC_ID;

-----FULL OUTER JOIN-----
SELECT D.DOC_NAME,D.DOC_SPECIALIZATION,P.PATIENT_ID,P.PATIENT_NAME,P.PATIENT_DISEASE,P.PATIENT_TREATMENT_TYPE
FROM DFA_HEALTHCARE_DOCTOR AS D
FULL JOIN DFA_HEALTHCARE_PATIENT AS P 
ON D.DOC_ID=P.DOC_ID;



-----VIEWS-----
CREATE VIEW HEALTHCARE 
AS 
SELECT D.DOC_NAME,D.DOC_SPECIALIZATION,P.PATIENT_ID,P.PATIENT_NAME,P.PATIENT_DISEASE,P.PATIENT_TREATMENT_TYPE
FROM DFA_HEALTHCARE_DOCTOR AS D
INNER JOIN DFA_HEALTHCARE_PATIENT AS P 
ON D.DOC_ID=P.DOC_ID;

SELECT * FROM HEALTHCARE;


-----Using transaction table perform various operations ( DDL,DML,DCL,TCL)-----

-----DDL CREATE COMMAND-----
-----CREATING TABLE CINEME_TICKET IN DATABASE-----

CREATE TABLE DFA_CINEMATICKET_DATA
(
Film_Type	VARCHAR(100),
film_code	VARCHAR(100),
cinema_code	VARCHAR(100),
total_sales	VARCHAR(100),
tickets_sold VARCHAR(100),	
tickets_out	VARCHAR(100),
show_time	VARCHAR(100),
occu_perc	VARCHAR(100),
ticket_price VARCHAR(100),	
ticket_use VARCHAR(100),	
capacity	VARCHAR(100),
t_date	VARCHAR(100),
t_month	VARCHAR(100),
t_quarter VARCHAR(100),	
t_day VARCHAR(100),
);




-----DML INSERT COMMAND-----
-----INSERTING VALUES TO THE TABLE DFA_CINEMATICKET -----

INSERT INTO DFA_CINEMATICKET_DATA VALUES('Fiction',1481,163,26160000,218,0,4,78.14,120000,218,279,43192,4,2,2);
INSERT INTO DFA_CINEMATICKET_DATA VALUES('Fiction',1481,291	,2460000,82,0,3,15.05,30000,82,545,43193,4,2,3);
INSERT INTO DFA_CINEMATICKET_DATA VALUES('Action',1482,524,2490000,25,0,3,28.74,99600,25,87,43240,5,2,20);
INSERT INTO DFA_CINEMATICKET_DATA VALUES('Science',1485,314,1400000,20,0,2,4.14,70000,20,483,43192,4,2,2);
INSERT INTO DFA_CINEMATICKET_DATA VALUES('Family',1483,73,19800000,167,0,8,7.44,118562.8743,167,2245,43205,4,2,15);



-----DISPLAYING THE INSERTED VALUES TO TABLE
SELECT * FROM DFA_CINEMATICKET_DATA;


-----DML UPDATE COMMAND-----
-----UPDATING SHOW_TIME FOR FILM_CODE=1483 FROM 8 TO 10 IN TABLE-----

UPDATE DFA_CINEMATICKET_DATA
SET SHOW_TIME=10
WHERE FILM_CODE=1483;


-----DDL ALTER COMMAND-----
-----ALTER COMMAND TO ADD NEW COLUMN NAMED THEATRE NAME-----

ALTER TABLE  DFA_CINEMATICKET_DATA  ADD THEATRE_NAME VARCHAR(100);    


-----DML DELETE COMMAND-----
-----DELETE COMMAND IS USED TO DELETE THE ROW WHERE FILM_CODE=1482 IN TABLE-----

DELETE FROM DFA_CINEMATICKET_DATA WHERE FILM_CODE=1482;


---DDL TRUNCATE COMMAND-----
-----TRUNCATE COMMAND USED TO EMPTY THE TABLE-----

TRUNCATE TABLE DFA_CINEMATICKET_DATA;


-----DDL DROP COMMAND-----
-----DROP COMMAND USED TO DROP THE TABLE-----

DROP TABLE DFA_CINEMATICKET_DATA;


-----FOR COVID HEALTHCARE DATASOURCE-----

-----CREATE TABLE-----
CREATE TABLE DFA_COVIDHEALTHCARE_DATA
(
DRG_ID	VARCHAR(100),
DRG_Definition	VARCHAR(100),
Provider_Id	VARCHAR(100),
Provider_Name	VARCHAR(100),
Provider_Street_Address	VARCHAR(100),
Provider_City	VARCHAR(100),
Provider_State	VARCHAR(100),
Provider_ZipCode VARCHAR(100),
Hospital_Referral_Region_Description VARCHAR(100),
Total_Discharges VARCHAR(100),	
Average_Covered_Charges	VARCHAR(100),
Average_Total_Payments	VARCHAR(100),
Average_Medicare_Payments VARCHAR(100)	
);


-----DML INSERT COMMAND-----
-----INSERTING VALUES TO THE TABLE DFA_COVIDHEALTHCARE_DATA -----

INSERT INTO DFA_COVIDHEALTHCARE_DATA VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10001,'SOUTHEAST ALABAMA MEDICAL CENTER','1108 ROSS CLARK CIRCLE','DOTHAN','AL',36301,'AL - Dothan',91,32963.07692,5777.2417580000001,4763.7362640000001);
INSERT INTO DFA_COVIDHEALTHCARE_DATA VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10005,'MARSHALL MEDICAL CENTER SOUTH','2505 U S HIGHWAY 431 NORTH','BOAZ','AL',35957,'AL - Birmingham',14,15131.85714,5787.5714289999996,4976.7142860000004);
INSERT INTO DFA_COVIDHEALTHCARE_DATA VALUES(39,'EXTRACRANIAL PROCEDURES W/O CC/MCC',10006,'ELIZA COFFEE MEMORIAL HOSPITAL','205 MARENGO STREET','FLORENCE','AL',35631,'AL- Birmingham',24,37560.375,5434.9583329999996,4453.7916670000004);
INSERT INTO DFA_COVIDHEALTHCARE_DATA VALUES(292,'HEART FAILURE & SHOCK W CC',450083,'EAST TEXAS MEDICAL CENTER',1000,'SOUTH BECKHAM STREET','TYLER','TX',75701,'TX - Tyler',145,51695.448279999997,5913.1172409999999,5156.4965519999996);
INSERT INTO DFA_COVIDHEALTHCARE_DATA VALUES(292,'HEART FAILURE & SHOCK W CC',450085,'GRAHAM REGIONAL MEDICAL CENTER',1301,'MONTGOMERY ROAD','GRAHAM','TX',76450,'TX - Fort Worth',18,10734.88889,6168.1111110000002,5605.6666670000004);




-----DISPLAYING THE INSERTED VALUES TO TABLE
SELECT * FROM DFA_COVIDHEALTHCARE_DATA;


-----DML UPDATE COMMAND-----
-----UPDATING SHOW_TIME FOR Provider_Id=1005 IN TABLE-----

UPDATE DFA_COVIDHEALTHCARE_DATA
SET Provider_ZipCode=576213
WHERE Provider_Id=1005;


-----DDL ALTER COMMAND-----
-----ALTER COMMAND TO ADD NEW COLUMN NAMED Total_Charges-----

ALTER TABLE  DFA_COVIDHEALTHCARE_DATA  ADD Total_Charges INT;    


-----DML DELETE COMMAND-----
-----DELETE COMMAND IS USED TO DELETE THE ROW WHERE Provider_Id =450083 IN TABLE-----

DELETE FROM DFA_COVIDHEALTHCARE_DATA WHERE Provider_Id =450083;


---DDL TRUNCATE COMMAND-----
-----TRUNCATE COMMAND USED TO EMPTY THE TABLE-----

TRUNCATE TABLE DFA_COVIDHEALTHCARE_DATA;


-----DDL DROP COMMAND-----
-----DROP COMMAND USED TO DROP THE TABLE-----

DROP TABLE DFA_COVIDHEALTHCARE_DATA;














